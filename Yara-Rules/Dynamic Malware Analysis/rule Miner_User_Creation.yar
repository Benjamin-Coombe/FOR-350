rule Miner_User_Creation
{
    meta:
        description = "Detects creation of hardcoded 'uubuntu' sudo user for the cryptominer"
        author      = "Benjamin Coombe"
        date        = "12/12/25"

    strings:
        $elf_magic = { 7F 45 4C 46 }

        $useradd   = "useradd -m -s /bin/bash uubuntu"
        $passwd    = "uubuntu:Mining@2025"
        $sudo      = "usermod -aG sudo uubuntu"
        $wheel     = "usermod -aG wheel uubuntu"

    condition:
        $elf_magic at 0 and
        $useradd and
        $passwd and
        $sudo and
        $wheel
}
